<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Dorado Events</title>
  </head>
  <body>
    <h1>Dorado Events</h1>

    <form id="eventForm">
      <input name="title" placeholder="Event title" required />
      <input name="starts_at" type="datetime-local" step="1" required />
      <button type="submit">Add Event</button>
    </form>

    <h2>All Events</h2>
    <ul id="eventList"></ul>

    <script>
      const form = document.getElementById('eventForm');
      const list = document.getElementById('eventList');

      async function loadEvents() {
        list.innerHTML = '';
        const res = await fetch('/api/events');
        const events = await res.json();
        events.forEach(ev => {
          const li = document.createElement('li');
          li.textContent = ev.title + ' @ ' + new Date(ev.starts_at).toLocaleString();
          list.appendChild(li);
        });
      }

      form.onsubmit = async (e) => {
        e.preventDefault();
        const fd = new FormData(form);
        const iso = new Date(fd.get('starts_at')).toISOString();
        await fetch('/api/events', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ title: fd.get('title'), starts_at: iso })
        });
        form.reset();
        loadEvents();
      };

      loadEvents();
    </script>
  </body>
</html>

